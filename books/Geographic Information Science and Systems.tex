

\chapter{地理信息系统与科学}
\Large\textbf{Geographic Information Science and Systems}
\par \emph{Paul A. Longley, Michael F. Goodchild, David J. Maguire, David W. Rhind} \normalsize

\section{引言}

\par 格言："Everything that happens, happens somewhere."

\par 涉及地理信息的问题场景分类标准：（1）空间尺度，或涉及到的地理细节的层次。（2）时间尺度。（3）目的，好奇心驱动的科学研究或现实世界中的问题求解。二者使用的方法没有明显区别。

\par Geographic, Geo-spatial, Spatial往往可以混用。后者强调不限于地球表层空间，事实上空间分析也适用于其它星球、宇宙空间、人体空间等。

\par Spatial is Special（GI的特殊性）：
\begin{itemize}
    \item 几乎所有的人类活动和决策涉及位置因素，而且后者是十分重要的
    \item 空间数据是高维数据（二/三维位置加属性）；数据量可能很大；可能需要多源融合
    \item 在计算机中有不同表达方式；可以在不同尺度进行表达；需要投影到平面
    \item 需要独特的分析和可视化方法
\end{itemize}

\par 知识(Knowledge)分为可编码(codified)和隐性(tacit)知识，前者容易书写和传递，后者难以传递。

\par 地理知识可区分为关于形式的(form，how it looks)，和关于过程的(process, how it works)。后者可以用于预测，因而更有价值；一般也具有更强的可泛化性。个案式的地理学(idiographic)更关注形式，强调区域特性；普适式的地理学(nomothetic)寻求普适的过程。两者都是必要的，实际问题的解决需要普适过程知识和具体区域知识的结合。 GIS恰恰实现了这种结合，具体信息存储在数据库中，而普适知识由GIS中的分析方法和工具实现；GIS既提供了不同地点间泛化的途径，又顾及了不同地点间独特的语境。

\par \textbf{地理信息系统}是基于计算机的，用于收集、存储、处理、分析、可视化地理信息的工具。从某种意义上说，整个数字世界已经成为一个巨大的、互联的地理信息系统（Twitter, Flickr, 信令和行车轨迹）；GIS的边界变得模糊，几乎人人都是GIS用户。

\par 地理信息系统的组成部分：硬件, 软件, 数据, （组织管理上的）流程, 人, 网络。硬件包括台式机，笔记本、车载设备等；软件可以是开源或商业软件，在本地或云端；大数据指数据量大、结构复杂，超出传统数据管理和处理工具能力。

\par \textbf{地理信息科学}是使地理信息系统得以实现的一般知识和重要发现，与技术细节相比具有相对的稳定性。其核心动机是世界中时空现象的表达，包括形式和过程两个层面。作为一门科学，其应当具备假设和方法的透明性、客观性、可重复性、结果可验证性、可泛化性。Varenius计划指出GIScience位于个体、计算机、社会三者的交汇点。UCGIS与AAG共同编制了地理信息科学与技术知识体系(GISBoK). 

\par 对于社会和环境科学而言，控制条件实验有时难以实施，带来不确定性；且个体具有自主性，故难以得到严格的规律(law)，往往有反例。

\par 场所(Place)是人类对空间的社会建构。空间独立于人而存在，人的交互和经验通过共同的感知和认识将空间塑造为场所。

\par \textbf{发展历史}：开创时期（20世纪六七十年代），商业化时期（20世纪八九十年代），开放和泛用时期（21世纪以来）。1963年加拿大地理信息系统诞生，最初的目的是土地管理中的面积测量；1967年双重独立地图编码(Dual Independent Map Encoding)程序诞生，服务于美国人口普查的街道数字化。70年代末，哈佛大学开发了通用的Odyssey GIS。几乎独立地，60年代末英国制图部门开始尝试计算机制图，到70年代末主要国家制图机构都实现了一定程度上的计算机化。80年代初，计算设备成本下降，GIS产业开始快速发展。1981年ESRI ArcInfo发布。

\par \textbf{学科地位}：
\begin{itemize}
    \item 商业视角：软件产业、数据产业（政府测绘部门、遥感影像公司、OpenStreetMap等）、地理信息服务（提供解决方案）。
    \item 政府视角：商业GIS的最大用户群体；分发地理信息数据，特别是公众事务数据(Public-sector information)。
    \item 信息科学视角：GIScience可以视为信息科学或计算机科学的分支。从技术角度，时空数据库、计算几何的很多议题属于计算机科学范畴，但地理信息的独特性决定了其很多原理与信息科学关系微弱。
    \item 地理学视角：GIS的很多基础来源于地理学中的空间分析传统。GIS的发展与地理学、测绘学、规划、景观等学科紧密相关。Neogeography 用于描述互联网制图和网上地理信息传播的发展，其基础是用户和网站的双向交互，如WikiMapia和OpenStreetMap. 仍有地理学家对地理研究中GIS的使用持怀疑态度。
    \item 社会视角：软件商会利用用户暴露的位置信息，或通过cookie记录偏好，用于用户画像和广告精准投放。志愿者地理信息(Volunteered Geographic Information)指个体自愿提供的地理数据，其内容、范围、收集过程往往定义不完善；志愿者的能力和知识存在差异，数据覆盖也受可达性、个人兴趣等因素影响。有观点批评GIS在社会科学中的应用，认为其代表了逻辑实证论(logical positivism，即只有可以用逻辑解决的问题才有意义)。
\end{itemize}

\par \textbf{社会问题}：
\begin{itemize}
    \item 知识与权力的关系。GIS对地表的表达可能对特定人群有利，少数人群或个体的意见可能被忽视。
    \item 用于军事（对别国的测绘）、侵犯个人隐私（监视）或被恶意目的利用（如开放珍稀动物分布数据引发盗猎，弱势群体数据引发犯罪等）。很多人不知道其个人信息如何被采集、使用。
\end{itemize}

\par 实例：地理家谱学(Geo-Genealogy)，分析姓氏的空间分布及其演变过程，也用于研究族群分布。种群基因学(Population Genetics)，Walter Bodmer 研究英国人等位基因的空间分布，反映族群入侵、定居的历史进程。

\section{地理数据的性质}

\par 有关空间变异(spatial variation)性质的基本原理：邻近效应，尺度效应，不同地理现象的共变性(covariation，同一位置不同属性存在联系)。
\par \textbf{属性数据的分类}：名义(nominal)，有序(ordinal)，间隔(interval)，比率(ratio)四种类型。循环量(如方位角)需要特殊处理，不能直接平均（359°与1°平均非180°）。若要作为输入特征，一种处理方式是采用方位角的正弦和余弦。
\par 制图中还区分spatially extensive与intensive变量。前者仅对整个区域有意义（如计数），可视为某一密度场在区域内的积分；后者在区域同质情况下对每一点都有意义（如密度，比率），可视为某一场在区域内的平均。一般认为等值区域图(choropleth map)不能用于spatially extensive变量。
\par 空间对象可以是自然的或假想的（如质心），按维度分为点(point)、线(line)、面(area)、体(volume)。实体的表达方式决定了空间变异的分析方法，且与尺度密切相关。
\par Scale一词的多重含义：(a)数据的细节层次(level of details, granularity)，即空间分辨率；(b)研究项目的范围(extent)；(c)地图的比例尺(representative fraction). \emph{Lam认为有四种含义，还包括空间过程的范围(spatial extent of a spatial process).}

\par \textbf{空间自相关}：由位置和属性的相似性决定。若空间上相似的事物属性也相似，称为正空间自相关，与Tobler第一定律一致；反之为负空间自相关。空间自相关有助于对世界的建模，但不利于地理变量的统计推断和预测（\emph{违反了样本独立性假设}）。
\par ``The past is the key to the present''概括了事件发生的时间语境。时间上的因果只有一个方向，解释当下只需要考虑过去；而空间现象的解释需要考虑所有方向。我们认为时间相近的事件关联更强；Tobler地理学第一定律是其在空间上的类比，即相近的位置更相关或相似。Tobler定律意味着空间分布的连续渐变性，现实中也存在不规则突变的反例。
\par 认识空间自相关的两种途径：演绎法(deductive)依据理论推导；归纳法(inductive)从数据出发度量自相关。自相关统计量通常考虑位置相似度（即空间权重$w_{ij}$）与属性相似度$c_{ij}$的交叉乘积$\sum_{i,j}w_{ij}c_{ij}$，可用于空间点或多边形图层的属性，或网络的边权。\emph{假定地理过程不存在异质性，}低空间自相关可能表明存在局部性的影响因子；而高空间自相关往往伴随区域尺度的变异，可能受大尺度因子影响。

\par \textbf{空间异质性}：``the tendency of geographic places and regions to be different from each other''. 空间变异可能是可控(controlled variance)的或不可控的(uncontrolled variance)，前者在某一均值附近振荡；后者观测时间越长变化越剧烈。 一般而言，距离越大，空间数据的变幅越大，异质性越强。

\par \textbf{空间采样}：数据采集涉及尺度、采样方式、样本权重。事实上任何地理表达都可以视为采样的结果。采样过程要求采样范围(sample frame)内每个样本被选中的概率已知，由此可借助统计推断将样本性质推广到总体。一般的空间采样方式包括随机采样、系统抽样（等间隔格点）等。系统抽样对于具周期模式的空间分布（如规则街区）可能不具代表性，对此可先划分均匀网格再在格内随机选点。当采样难以覆盖整个区域时，可在有代表性的若干局部区域聚集采样。有时需要划分子区域，进行分层采样，如异质性明显的区域比相对同质的区域需要更小的采样间隔。对于空间结构已知情形，可以设计有针对性的采样方案，如沿样带、等高线采样。

\par \textbf{距离衰减}：体现在某一地点与其它地点的交互或影响力中，如污染物排放、噪声传播、公园游客等；也用于空间插值中采样点的加权。常见的衰减权重包括线性型($w_{ij}=a-bd_{ij}$)，幂律型($w_{ij}=d_{ij}^{-b}$)，指数型($w_{ij}=e^{-bd_{ij}}$)等，这假定了距离衰减是连续变化、各向同性的，实际有时并非如此（如诊所的服务区受交通状况、自然因素影响，并非圆形缓冲区）。

\par 尺度变换下众多自然、人文现象呈现自相似特性，其带来的不规则空间变异难以用连续光滑函数表达，可用分形维数等概念描述。

\section{地理表达}

\par \textbf{地理表达}: 对地球表层空间的一部分构建模型，尺度覆盖从建筑物到全球。其目的是满足人们对直接感知范围之外的空间和时间的认知需求（如地理大发现时代地图发挥的巨大作用）；此外现实世界中的计划也可以利用模型仿真模拟。借助多种形式的表达（个体记忆、照片、文字记录、测量数据等），人们可以集成远超于个体所能的关于世界的知识。本书关注计算机设备中基于0和1的数字模型(digital model)，其相比于纸质地图具有易存储、易复制、表达能力强（动态、三维、不必投影到平面）、便于分析的优点。计算机无法表达无限复杂的现实世界，必须限制细节的层次，忽略某些属性或其时态变化。

\par 数据的二进制表示法：整型（short, long）、浮点型（single: 7位有效数字; double: 14位）、ASCII码、BLOB(binary large object,用于图像、音频等)。

\par ``Geographic data link place, time, and attributes.'' 地理数据的最小单元包含位置、时间（可选）和属性信息。``珠峰海拔为8848.86米''可分解为两条原子信息：珠峰的经纬度、这一位置的海拔高度。\emph{这一最小单元即Geo-atom。} 其中地理位置是将地理信息与其它信息区别开来的要素。

\par \textbf{对象模型}：离散的对象模型认为空间本是空的，边界明确的对象占据了空间，对象是更广泛类属的实例。对象模型对于边界不易确定的事物（如山峰、湖泊）面临困难。\emph{认为对象属性均质也是一个局限。} ``Nothing on the natural Earth looks remotely like a table!'' GIS对三维对象的处理能力有限，一般近似为更低维度的对象。交通网络中的overpass和underpass可通过记录一个方向可否转向另一方向实现。

\par \textbf{场模型}：连续的场模型认为地理世界可以用一系列变量描述，这些变量可以在地表每个位置被测量；包括标量场和矢量场。场的变化有是否平滑之分，地块类型可视为一种边界突变的场；人口密度也是一种场，但在面积单元过小（小于个体尺度）时无意义。

\par 对象模型和场模型只是概念模型，仍包含无限的信息量，没有解决数字化表达问题。栅格和矢量是解决这一问题的两种方式。离散对象易于用矢量表达，而连续场的计算机建模有采样点（规则或非规则）、规则网格、不规则多边形、不规则三角网(Triangulated Irregular Network, TIN)、等高线等方式，其中除规则采样点、网格外均属于矢量模型。与对象模型不同，它们并非真实存在的地理对象。

\par \textbf{地理信息综合}(generalization): 对要素的综合体现在特定比例尺下的制图规范中（如决定多大的要素绘在图上）。McMaster和Shea归纳了十种制图综合操作。折线的简化是最常见的制图综合形式之一，可用Douglas-Poiker算法实现。一些GIS已开始支持圆弧、椭圆弧、Bézier曲线等，但其简化和分析方法尚无共识。此外要素的属性信息也涉及综合。

\par 纸质地图在计算机中存储的方式包括数字线划地图(digital line graph)和数字栅格地图(digital raster graphic)。空间数据集来源于纸质地图时，地图的比例尺有时被称为数据集的比例尺。互联网地图可将矢量数据即时渲染为栅格发送到移动客户端，以实现方向调整等需求。

\par 与空间相关的核心概念（如包含、邻近性）和空间数据模型一起构成了本体(ontology)，即获取地理知识的框架。

\section{地理参照}

\par 地理参照(georeference; geolocate, geocode与之近义)即在地理信息中指定地理位置的过程，涉及地理位置的表达。

\par \textbf{地理参照系统的要求}：(1)使用范围内的唯一性，每个参照对应唯一地点；(2)含义被该系统使用者共享；(3)时间上的稳定性（反例如地名、行政边界的演变）；(4)位置精度（即不确定性，可用面积表示，与分辨率或测量误差有关）。前两项为基本要求。

\par \textbf{地名和POI}: 地名词典(gazetteer)包含官方定义的标准名称，兴趣点(point-of-interest, POI)数据库也已被集成，用于互联网地图服务。由于邮政系统的发展，一个县(county)范围内的地名一般没有重复，但全球范围内地名重复仍很常见。街道名称一般仅在同一城市唯一。同一地物也可能存在多个名称。地名的位置不确定度往往较大；大量地名未被官方确认，只用于当地社群中。Wikimapia的出现一定程度上改变了这一状况，居民可以独立地命名当地地物。事实上在政府测绘部门出现之前的时代，地名命名也是一种个体行为（如制图师Waldseem\"uller对America的命名）。

\par \textbf{邮政地址和编码}: 对邮政业务可达的住宅、办公室提供地理参照。大量自然地物没有邮政地址和编码。若住宅不沿街道一次编号，无法用线性插值估计位置（如日本门牌号按建筑年代编号）。大量GIS应用依赖通信地址到经纬度的转换（\emph{在互联网地图API中被称作地理编码，反向转换为逆地理编码}）。

\par \textbf{IP地址}: 每个连接到互联网的设备有唯一的IP地址，可用于概略定位。

\par \textbf{线性参照系统}: 通过从特定点（网络节点）出发，沿特定路径（网络中的边）的距离描述位置，用于公路、铁路、电网、管道网络等。两条路多次相交，或路与自身相交，可能给线性参照带来问题。

\par 基于坐标系的\textbf{度量参照}(metric georeference)理论上可以实现无限高的定位精度，且便于距离计算。

\par 经度$\lambda$的定义可适用于任何旋转体，而纬度$\phi$的定义依赖于椭球体（椭球面垂线与赤道面夹角）。不同椭球体下同一经纬度的位置可相差\SI{100}{\metre}之多。同一经线圈上纬度的\ang{1}约为\SI{111}{\kilo\metre}, 1’约为\SI{1.86}{\kilo\metre}（也即1海里）；赤道上经度类似，其它纬线圈经度则向两极减小。以十进制小数表示时，纬度小数点后第5位约为\SI{1}{\metre}，受精度限制一般不需要表达更多位数。地表两点大圆距离的计算公式为：
\begin{displaymath}
R\arccos (\sin\phi_1 \sin \phi_2 +\cos \phi_1 \cos \phi_2 \cos(\lambda_1-\lambda_2)).
\end{displaymath}

\par 将地球表面投影到平面的目的包括：(1)平面地图、图像（如航空相片）作为地理信息的输入、输出媒介；(2)栅格本质上是平面的；(3)同时展现地球表面的全貌。

\par 地图投影的性质主要有等角(conformal)、等积(equal area)，二者不可得兼。前者保证每一点处不同方向的缩放比例相同，后者保证地图上的面积缩放比例相同。还可分为圆柱(cylindrical)，圆锥(conic), 方位或平面(azimuthal,planar)投影；这三个主要类别并未涵盖所有投影。

\par 常见投影：
\begin{itemize}
    \item Plate Carr\'{e}e投影：直接将经纬度对应为x,y；也称unprojected projection，等距正轴圆柱投影，每一点到赤道距离的缩放比例相同。由于经纬度1°的差异可能很大，不适于GIS空间分析。
    \item Lambert等角圆锥投影
    \item Mercator投影：等角正轴切圆柱投影，能保持恒定航向的航线为直线。
    \item UTM(Universal Transverse Mercator)：等角横轴割椭圆柱投影，按6°分带后缩放比例在0.9996（中央经线）至1.0004（分带边界）之间。UTM分带坐标系伪东偏移\SI{500}{\kilo\metre}，南半球伪北偏移\SI{10000}{\kilo\metre}。分带给跨边界的城市或国家带来困难，高纬地区常改用切点为极点的方位投影。
\end{itemize}

\par 全球导航卫星系统可用于测量经纬度和高程。确定经纬度需要地平线上至少三颗卫星；确定经纬度和高程需要四颗。GPS的平面定位精度约\SI{10}{\metre}（使用差分GPS可提升至\SI{1}{\metre}）；高程精度约\SI{50}{\metre}。

\par 混搭(mashup)指组合两种或以上互联网服务，实现它们各自不具备的新功能。如将住房列表接口与互联网地图组合，得到住房地图。

\par 地理配准(georegistration)可以根据一组参考点拟合变换方程，将未知坐标系的几何数据或图像配准到已知坐标系的图像。

\section{不确定性}

\par 大多数地理表达不完备，带来不确定性。不确定性(uncertainty)描述数据集内容与其数据表达的现象的差异，可以作为表达质量的笼统描述，不区分与vagueness, fuzziness, imprecision, inaccuracy等概念的差异。不确定性可在概念化(conception)、地理表达(representation)、数据分析(analysis)三个环节中产生并积累。

\par \textbf{概念化中的不确定性}：包括地方(place)和属性(attribute)的概念化。
\par 地方(place)概念化为带边界的分析单元，但很多情况下地理分析没有自然的单元。Barry Smith区分了两种空间边界：自然具有的(\emph{bona fide})和人为划定的(\emph{fiat})；地理分析中的单元多数是后者。划分同质区域(homogeneous zone)从而最大化区域间异质性，是区域地理学的基本主题。另一种方式是划分功能区(functional zone)使区内交互量最大、区域间交互量最小；或根据设施的影响范围分划。
\par 属性（类别）标签可能具有主观性、模糊性，模糊逻辑可缓解这一问题，但其隶属度的精确性受争议（仍是主观的）。采用直接或间接的指数代替所描述的现象，也会因二者对应的不完全性产生不确定性。

\par \textbf{表达中的不确定性}：位置表达中，矢量线的简化有较大自由度；出于减少数据量或隐私保护目的，也将点数据（如个体位置）聚合到面单元。栅格影像中覆盖多种类型土地的像元称为混合像元(mixel)，当分类数目不变，混合像元比例随分辨率提高而减少。

\par \textbf{分析中的不确定性}：计算结果的误差可利用数据误差的度量和分布分析得到，也可采用重复模拟的方法评估。误差的空间结构（空间自相关性质）对GIS分析操作的不确定性有重要影响，使误差对许多操作的影响减小（如计算两点间距离、坡度），也减少了数据集的``自由度''；但当两数据集叠加时，误差可能会较大。利用模拟分析误差的影响时，应考虑误差的空间自相关。
\par 生态谬误(ecological fallacy)指基于聚合数据对个体特性的不合理推断。分析单元内的异质性会增加生态谬误出现的可能性和严重性。与之相对的是原子谬误(atomistic fallacy)，即认为个体孤立于所处的环境。
\par 可变面积单元问题(modifiable areal unit problem)：包括尺度效应(scale effect)和分区效应(zoning effect)。双变量相关系数通常随聚合尺度增大而变得更显著（一个实例由Yule和Kendall发现）；多变量分析的尺度效应没有一致、可预测的趋势。1984年Openshaw的研究表明，相关和回归分析中的不同预设结果可通过调整分区方式实现；1812年gerrymander事件是一个现实实例。用地学计算(geocomputation)方法进行区域划分，有助于理解输出的敏感性，但难以得到无可争议的最优解。分析单元的划分方式难以用抽样和统计推断的方法处理。作者提倡依据清晰的假设定义分析单元，并用（反映单元内部异质性的）外部数据源验证划分的合理性。

\par \textbf{不确定性的度量方法}：
\par 分类变量：混淆矩阵(confusion matrix)，相比于正确率，Kappa指数用随机分类结果进行修正:
\begin{displaymath}
\kappa = \frac{\sum_i c_{ii}-\sum_i c_{.i}c_{i .}/c_{..}}{c_{..}-\sum_i c_{. i}c_{i .}/c_{..}}.
\end{displaymath}
其中$n$为类别数，.代表求和。分类图中的错误不仅存在于类别标签，还存在于区块边界的位置。
\par 连续变量：精度(precision)通常指测量结果有效数字的位数（报告结果时应当与实际准确度相对应，不提供更多位数），也用于描述重复测量时结果的变异程度。准确度(accuracy)描述测量结果(均值)与真实值的差异。两者没有必然联系，高精度的结果仍可能是有偏的(biased)。误差的常用度量指标是均方根误差(RMSE)，很多情况下误差符合正态分布。位置的误差可用多元正态分布描述。

\par \textbf{如何应对不确定性？}(1)认识到不确定性是不可避免的，而非装作其不存在；(2)不能将数据当做真实，利用元数据中的数据质量信息评估其可用性；(3)利用多种数据源进行外部校正，如遥感影像和矢量地图、DEM和高程点数据；(4)在报告GIS分析结果时体现对不确定性的认识。

